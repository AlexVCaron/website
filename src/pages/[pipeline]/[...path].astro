---
import pipelines_json from '@public/pipelines.json';

export function getStaticPaths() {
    var staticPaths: { params: { pipeline: string; path: string }; props: { latestRelease: string } }[] = [];
    const subPaths = ['docs/usage', 'docs/output', 'results', 'parameters'];
    pipelines_json.remote_workflows.forEach((pipeline) => {
        subPaths.forEach((subpath) => {
            staticPaths.push({
                params: {
                    pipeline: pipeline.name,
                    path: subpath,
                },
                props: {
                    latestRelease: pipeline.releases[0].tag_name,
                },
            });
        });
    });
    return staticPaths;
}

const { pipeline, path } = Astro.params;
const { latestRelease } = Astro.props;

return Astro.redirect(`/${pipeline}/${latestRelease}/${path}`);
---
