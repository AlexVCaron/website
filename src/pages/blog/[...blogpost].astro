---
import MarkdownTocLayout from '@layouts/MarkdownTocLayout.astro';
import { getCollection } from 'astro:content';
import SidebarStatsRow from '@components/sidebar/SidebarStatsRow.astro';
import GitHubProfilePictureExtended from '@components/GitHubProfilePictureExtended.svelte';

export async function getStaticPaths() {
    const blogPost = await getCollection('blog');
    return blogPost.map((post) => ({
        params: { blogpost: post.slug },
        props: { post },
    }));
}
const { post } = Astro.props;
const { headings, Content } = await post.render();
const title = post.data.title;
const subtitle = post.data.subtitle;
const md_github_url = 'https://github.com/nf-core/website/blob/main/src/content/blog/' + post.id;
const headerImage = post.data.headerImage;
---

<MarkdownTocLayout
    title={title}
    subtitle={subtitle}
    meta_title={'Blog:' + title}
    md_github_url={md_github_url}
    headings={headings}
    image={`/og.png?title=${encodeURIComponent(title)}&background_image=${encodeURIComponent(
        headerImage ? headerImage : '',
    )}}`}
    viewTransitions={true}
    left_sidebar={true}
>
    <Content />
    <div slot="right-sidebar" class="d-flex flex-column align-items-start">
        <SidebarStatsRow lastChild={true} content={[{ title: 'Written by' }]}>
            {
                post.data.authors.map((author) => {
                    return <GitHubProfilePictureExtended username={author} size={40} />;
                })
            }
        </SidebarStatsRow>
        <SidebarStatsRow lastChild={true} content={[{ title: 'Published on' }]}>
            {
                post.data.pubDate.toLocaleDateString('en-GB', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                })
            }
        </SidebarStatsRow>
    </div>
</MarkdownTocLayout>
