---
import Markdown from '@components/Markdown.svelte';
import Toc from '@components/Toc.svelte';
import MarkdownTocLayout from '@layouts/MarkdownTocLayout.astro';
import PageLayout from '@layouts/PageLayout.astro';
import { getCollection } from 'astro:content';
import { marked } from 'marked';

export async function getStaticPaths() {
    const docs = await getCollection('docs');
    return docs.map((doc) => ({
        params: {
            doc: doc.slug,
        },
        props: {
            doc: doc,
        },
    }));
}
marked.setOptions({
    baseUrl: Astro.params.slug, // add the slug to the base url of relative links
});
const title = Astro.props.doc.data.title;
const subtitle = Astro.props.doc.data.subtitle;
let frontmatter = Astro.props.doc.data;
let body = Astro.props.doc.body;
const { headings, Content, remarkPluginFrontmatter } = await Astro.props.doc.render();

// TODO: update github url
const md_github_url = 'https://github.com/nf-core/nf-co.re/blob/master/markdown/docs/' + Astro.props.doc.id;
---

<MarkdownTocLayout title={title} subtitle={subtitle} md_github_url={md_github_url} headings={headings}>
    <Content />
</MarkdownTocLayout>
