---
import pipelines_json from '@public/pipelines.json';
import { getCollection } from 'astro:content';

const abouts = await getCollection('about');

export const prerender = false;

const { pipeline } = Astro.params;

const meta = pipelines_json.remote_workflows.find((wf) => wf.name === pipeline);

if (!meta) {
    console.log(`Pipeline ${pipeline} not found`);
    return Astro.redirect('/404');
}

const last_release = meta.releases[0].tag_name === 'dev' ? meta.releases[1].tag_name : meta.releases[0].tag_name;
return Astro.redirect(`/${pipeline}/${last_release}/`);
---
