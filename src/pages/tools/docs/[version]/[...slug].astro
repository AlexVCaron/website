---
import MarkdownTocLayout from '@layouts/MarkdownTocLayout.astro';
import { getCollection } from 'astro:content';
import type { CollectionEntry } from 'astro:content';
// 1. Generate a new path for every collection entry
export async function getStaticPaths() {
    const tools: CollectionEntry<'tools'>[] = await getCollection('tools');
    return tools.map((entry: CollectionEntry<'tools'>) => {
        const version = entry.id.split('/')[1];
        const versioned_tools = tools.filter((tool) => tool.id.split('/')[1] === version);
        const section_names = [...new Set(versioned_tools.map((entry) => entry.id.split('/')[2]))];
        const sections = section_names.map((entry) => {
            return {
                section_name: entry,
                section_slug: entry.replace(/\.md$/, ''),
                children: versioned_tools
                    .filter((child) => child.id.split('/')[2] === entry && child.id.split('/')[3])
                    .map((tool_entry) => {
                        return {
                            title: tool_entry.id.split('/')[3].replace(/\.md$/, ''),
                            slug: '/tools/' + tool_entry.id.replace(/\.md$/, ''),
                        };
                    }),
            };
        });
        return {
            params: { version: version, slug: entry.id.replace(`docs/${version}/`, '').replace(/\.md$/, '') },
            props: { entry: entry, sections: sections },
        };
    });
}
// 2. For your template, you can get the entry directly from the prop
const { entry, sections } = Astro.props;
const { headings, Content } = await entry.render();
const { title } = entry.data;
const subtitle = entry.data.subtitle || '';
const md_github_url = 'https://github.com/nf-core/website/blob/main/src/content/tools/' + entry.id;
---

<MarkdownTocLayout
    title={title}
    subtitle={subtitle}
    md_github_url={md_github_url}
    headings={headings}
    viewTransitions={true}
    leftSidebar={true}
    sections={sections}
    viewTransitions={true}
    doubleNavbar={false}
>
    <Content />
</MarkdownTocLayout>
